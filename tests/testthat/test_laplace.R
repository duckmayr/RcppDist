context("Laplace Distribution")

test_that('The density functions provide correct answers', {
    x <- seq(from = -3, to = 3)
    mu <- 1.0; b <- 2.5
    expect_equal(test_dlaplace(x, mu, b),
                 list(
                     "VectorLog" = c(-3.209437912434, -2.809437912434,
                                     -2.409437912434, -2.009437912434,
                                     -1.609437912434, -2.009437912434,
                                     -2.409437912434),
                     "VectorNoLog" = c(0.040379303599, 0.060238842382,
                                       0.089865792823, 0.134064009207,
                                       0.200000000000, 0.134064009207,
                                       0.089865792823),
                     "DoubleLog" = c(-3.209437912434, -2.809437912434,
                                     -2.409437912434, -2.009437912434,
                                     -1.609437912434, -2.009437912434,
                                     -2.409437912434),
                     "DoubleNoLog" = c(0.040379303599, 0.060238842382,
                                       0.089865792823, 0.134064009207,
                                       0.200000000000, 0.134064009207,
                                       0.089865792823)
                 )
    )
})


test_that('The distribution functions provide correct answers', {
    x <- seq(from = -3, to = 3)
    mu <- 1.0; b <- 2.5
    expect_equal(test_plaplace(x, mu, b),
                 list(
                     "VectorLog" = c(-2.293147180560, -1.893147180560,
                                     -1.493147180560, -1.093147180560,
                                     -0.693147180560, -0.408208903401,
                                     -0.254459416938),
                     "VectorNoLog" = c(0.100948258997, 0.150597105956,
                                       0.224664482059, 0.335160023018,
                                       0.500000000000, 0.664839976982,
                                       0.775335517941),
                     "DoubleLog" = c(-2.293147180560, -1.893147180560,
                                     -1.493147180560, -1.093147180560,
                                     -0.693147180560, -0.408208903401,
                                     -0.254459416938),
                     "DoubleNoLog" = c(0.100948258997, 0.150597105956,
                                       0.224664482059, 0.335160023018,
                                       0.500000000000, 0.664839976982,
                                       0.775335517941),
                     "VectorLogNoLower" = c(-0.106414692215, -0.163221653946,
                                            -0.254459416938, -0.408208903401,
                                            -0.693147180560, -1.093147180560,
                                            -1.493147180560),
                     "VectorNoLogNoLower" = c(0.899051741003, 0.849402894044,
                                              0.775335517941, 0.664839976982,
                                              0.500000000000, 0.335160023018,
                                              0.224664482059),
                     "DoubleLogNoLower" = c(-0.106414692215, -0.163221653946,
                                            -0.254459416938, -0.408208903401,
                                            -0.693147180560, -1.093147180560,
                                            -1.493147180560),
                     "DoubleNoLogNoLower" = c(0.899051741003, 0.849402894044,
                                              0.775335517941, 0.664839976982,
                                              0.500000000000, 0.335160023018,
                                              0.224664482059)
                 )
    )
})


test_that('The quantile functions provide correct answers', {
    x <- c(0, 0.25, 0.5, 0.75, 1)
    mu <- 1.0; b <- 2.5
    expect_equal(test_qlaplace_nolog(x, mu, b),
                 list(
                     "VectorNoLog" = c(-Inf, -0.732867951400, 1.0,
                                       2.732867951400, Inf),
                     "DoubleNoLog" = c(-Inf, -0.732867951400, 1.0,
                                       2.732867951400, Inf),
                     "VectorNoLogNoLower" = c(Inf, 2.732867951400, 1.0,
                                              -0.732867951400, -Inf),
                     "DoubleNoLogNoLower" = c(Inf, 2.732867951400, 1.0,
                                              -0.732867951400, -Inf)
                 )
    )
    x <- c(-1, -2, -10)
    expect_equal(test_qlaplace_log(x, mu, b),
                 list(
                     "VectorLog" = c(0.232867951400, -2.267132048600,
                                     -22.267132048600),
                     "DoubleLog" = c(0.232867951400, -2.267132048600,
                                     -22.267132048600),
                     "VectorLogNoLower" = c(1.767132048600, 4.267132048600,
                                            24.267132048600),
                     "DoubleLogNoLower" = c(1.767132048600, 4.267132048600,
                                            24.267132048600)
                 )
    )
})

